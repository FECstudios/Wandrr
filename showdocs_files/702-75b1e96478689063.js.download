try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="23f2a39e-87a4-4c74-8727-a95b7505d0be",e._sentryDebugIdIdentifier="sentry-dbid-23f2a39e-87a4-4c74-8727-a95b7505d0be")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{10697:(e,t,s)=>{s.d(t,{Jd:()=>i,m6:()=>d,ru:()=>c,vu:()=>o});var r=s(95155),a=s(12115),l=s(20063);let n=(0,a.createContext)();function o(e){let{children:t,initialUser:s,initialProjects:o}=e,[i,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!0),[x,g]=(0,a.useState)(!0),[f,v]=(0,a.useState)(null),[p,y]=(0,a.useState)(!1),[j,b]=(0,a.useState)(!1),w=(0,a.useRef)(!1),N=(0,a.useRef)(0),k=(0,l.useRouter)(),S=(0,a.useCallback)((e,t)=>{try{e&&t?(localStorage.setItem("shov_user",JSON.stringify(e)),localStorage.setItem("shov_authenticated","true"),localStorage.setItem("shov_auth_timestamp",Date.now().toString())):(localStorage.removeItem("shov_user"),localStorage.removeItem("shov_authenticated"),localStorage.removeItem("shov_auth_timestamp"))}catch(e){console.warn("Failed to update localStorage:",e)}},[]),C=(0,a.useCallback)(()=>{try{let e=localStorage.getItem("shov_auth_timestamp");if(!e)return!1;return Date.now()-parseInt(e)<3e5}catch(e){return!1}},[3e5]),_=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!w.current){if(!t&&!e&&Date.now()-N.current<3e5&&i&&d){console.log("Using cached user data (TTL not expired)"),m(!1),g(!1);return}w.current=!0,e||m(!0);try{let e=await fetch("".concat("https://shov.com/api","/auth/me"),{credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();t.success&&t.user?(console.log("Auth refresh - user data:",{email:t.user.email,role:t.user.role,isAdmin:t.user.isAdmin,adminCheck:"admin"===t.user.role||t.user.isAdmin}),c(t.user),v(null),u(!0),S(t.user,!0),N.current=Date.now()):(c(null),v(null),u(!1),S(null,!1),N.current=0)}else c(null),v(null),u(!1),S(null,!1),N.current=0}catch(t){console.error("Failed to fetch user:",t),e||(c(null),v(null),u(!1),S(null,!1),N.current=0)}finally{m(!1),(!e||x)&&g(!1),w.current=!1}}};(0,a.useEffect)(()=>{y(!0);try{let e=localStorage.getItem("shov_user"),t=localStorage.getItem("shov_authenticated"),s=localStorage.getItem("shov_auth_timestamp");if(e&&"true"===t){let t=JSON.parse(e);c(t),u(!0),g(!1),m(!1),s&&(N.current=parseInt(s)),console.log("Loaded cached user data optimistically")}}catch(e){console.error("Failed to load cached user data:",e)}},[]),(0,a.useEffect)(()=>{p&&(i&&d?(console.log("Have cached data, doing background refresh to ensure current"),setTimeout(()=>_(!0),200)):(console.log("No cached data, doing immediate refresh"),_(!1)))},[p]);let I=(0,a.useCallback)(()=>_(!1,!0),[]),z=async()=>{try{let e=await fetch("".concat("https://shov.com/api","/auth/logout"),{method:"POST",credentials:"include"});e.ok||console.error("Logout failed:",e.status,e.statusText)}catch(e){console.error("Logout error:",e)}c(null),v(null),u(!1),S(null,!1),N.current=0,k.push("/")},A=(null==i?void 0:i.role)==="admin"||(null==i?void 0:i.isAdmin)||!1;return i&&("admin"===i.role||i.isAdmin)&&console.log("Admin user detected:",{email:i.email,role:i.role,isAdmin:i.isAdmin,finalAdminValue:A}),(0,r.jsx)(n.Provider,{value:{user:i,authenticated:d,loading:h,initializing:x,logout:z,refreshUser:_,forceRefreshUser:I,setUser:c,setAuthenticated:u,setLoading:m,setProjects:v,projects:f,isAdmin:A,projectDropdownOpen:j,setProjectDropdownOpen:b,isCacheValid:C},children:t})}function i(){return(0,a.useContext)(n)}function c(e){return function(t){let{authenticated:s,initializing:n}=i(),o=(0,l.useRouter)();return((0,a.useEffect)(()=>{n||s||o.push("/login?redirect_to=".concat(encodeURIComponent(window.location.pathname)))},[s,n,o]),n||s)?(0,r.jsx)(e,{...t}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-700 rounded w-48 mx-auto mb-4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-800 rounded w-32 mx-auto"})]})})})}}function d(e){return function(t){let{authenticated:s,initializing:n,isAdmin:o}=i(),c=(0,l.useRouter)();return((0,a.useEffect)(()=>{!n&&(s?o||c.push("/"):c.push("/login?redirect_to=".concat(encodeURIComponent(window.location.pathname))))},[s,n,o,c]),n||s&&o)?(0,r.jsx)(e,{...t}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-700 rounded w-48 mx-auto mb-4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-800 rounded w-32 mx-auto"})]})})})}}},24702:(e,t,s)=>{s.r(t),s.d(t,{default:()=>m});var r=s(95155),a=s(52619),l=s(15239),n=s(12115),o=s(10697),i=s(20063),c=s(80796);let d=()=>(0,r.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),u=()=>(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})}),h=()=>(0,r.jsxs)("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{d:"M12 1l2.5 7.5L22 11l-7.5 2.5L12 21l-2.5-7.5L2 11l7.5-2.5L12 1z",fillOpacity:"0.9"}),(0,r.jsx)("circle",{cx:"6",cy:"6",r:"1.5",fillOpacity:"0.7"}),(0,r.jsx)("circle",{cx:"18",cy:"4",r:"1",fillOpacity:"0.8"}),(0,r.jsx)("circle",{cx:"20",cy:"18",r:"1.2",fillOpacity:"0.6"}),(0,r.jsx)("circle",{cx:"4",cy:"20",r:"0.8",fillOpacity:"0.9"})]});function m(){var e;let{user:t,authenticated:s,logout:m,loading:x,refreshUser:g,isAdmin:f,projectDropdownOpen:v,setProjectDropdownOpen:p}=(0,o.Jd)(),[y,j]=(0,n.useState)(!1),[b,w]=(0,n.useState)(!1),[N,k]=(0,n.useState)(""),[S,C]=(0,n.useState)(!1),[_,I]=(0,n.useState)(""),[z,A]=(0,n.useState)(!1),D=(0,i.usePathname)();(0,i.useRouter)();let{sidebarOpen:L,setSidebarOpen:E}=(0,c.t)(),[R,O]=(0,n.useState)(null);(0,n.useEffect)(()=>{A(!0)},[]);let F=z&&s&&t&&!x,{organization:P,project:T}=(0,i.useParams)(),B=!!(P&&T&&D==="/".concat(P,"/").concat(T)),M=!!(P&&!T&&D==="/".concat(P));(0,n.useEffect)(()=>{var e;(null==t?void 0:t.organizations)&&P?O(t.organizations.find(e=>e.slug===P)):(null==t||null==(e=t.organizations)?void 0:e.length)>0&&O(t.organizations[0])},[t,P]);let U=(null==R?void 0:R.projects)||[],J=U.find(e=>e.slug===T)||U[0];return(0,r.jsx)("header",{className:"sticky top-0 z-50 border-b-2 border-dashed bg-[#0B0B0B] border-gray-700/50",children:(0,r.jsx)("div",{className:"w-full mx-auto px-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{className:"lg:hidden mr-4 text-gray-400 hover:text-white",onClick:()=>E(!L),children:(0,r.jsx)(u,{})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(a,{href:"/",className:"flex items-center",children:(0,r.jsx)(l.default,{src:"/logos/shov-logo-white.svg",alt:"shov",width:120,height:40,priority:!0,className:"h-6 w-auto"})}),(0,r.jsxs)(a,{href:"/ask",className:"lg:hidden relative flex items-center space-x-1.5 text-white px-3 py-1.5 rounded-md transition-all text-sm font-medium hover:scale-[1.02] transform overflow-hidden ".concat(F?"bg-gradient-to-r from-pink-500/80 to-pink-600/80 hover:from-pink-500/90 hover:to-pink-600/90 border border-pink-500/30 hover:border-pink-400/50 shadow-md shadow-pink-500/20 hover:shadow-pink-500/30":"bg-gradient-to-r from-pink-500 to-pink-600 hover:from-pink-500/90 hover:to-pink-600/90 border border-pink-400/50 hover:border-pink-300/70 shadow-lg shadow-pink-500/25 hover:shadow-pink-500/35"),children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-white/10 pointer-events-none"}),(0,r.jsx)(h,{className:"relative z-10"}),(0,r.jsx)("span",{className:"relative z-10",children:"Ask"}),(0,r.jsx)(h,{className:"relative z-10"})]})]}),F&&(0,r.jsxs)("div",{className:"hidden lg:flex items-center",children:[(0,r.jsx)("div",{className:"mx-4 h-6 border-l-2 border-dashed border-gray-700"}),(0,r.jsx)("div",{className:"relative",children:(0,r.jsxs)(a,{href:"/".concat(null==R?void 0:R.slug),className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium rounded-md transition-colors hover:bg-gray-800/50",children:[(0,r.jsx)("div",{className:"w-5 h-5 bg-gray-700 rounded-full flex items-center justify-center text-xs",children:null==R||null==(e=R.name)?void 0:e.charAt(0).toUpperCase()}),(0,r.jsx)("span",{className:M||B?"text-white":"text-gray-400",children:null==R?void 0:R.name})]})}),U&&U.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"mx-2 text-gray-600",children:"/"}),1===U.length?(0,r.jsx)(a,{href:"/".concat(R.slug,"/").concat(U[0].slug),className:"px-3 py-2 text-sm font-medium rounded-md transition-colors hover:bg-gray-800/50",children:(0,r.jsx)("span",{className:B?"text-white":"text-gray-400",children:U[0].name})}):(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>p(!v),className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-gray-300 hover:bg-gray-800/50 rounded-md transition-colors",children:[(0,r.jsx)("span",{className:B?"text-white":"text-gray-400",children:J?J.name:"Select Project"}),(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})})]}),v&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>p(!1)}),(0,r.jsxs)("div",{className:"absolute left-0 mt-2 w-64 bg-gray-900 rounded-lg shadow-lg border border-gray-700/50 py-2 z-50",children:[(0,r.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Projects"}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto",children:null==U?void 0:U.map(e=>(0,r.jsx)(a,{href:"/".concat(R.slug,"/").concat(e.slug),className:"block w-full text-left px-3 py-2 text-sm text-gray-300 hover:bg-gray-800",onClick:()=>p(!1),children:e.name},e.id))})]})]})]})]})]})]}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a,{href:"/".concat(null==R?void 0:R.slug),className:"lg:hidden flex items-center bg-black hover:bg-gray-800 text-white px-3 py-1.5 rounded-md transition-colors text-sm font-medium border border-gray-600 hover:border-gray-500",children:"Dash"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("button",{onClick:()=>j(!y),className:"p-1.5 rounded-full hover:bg-gray-800/50 transition-colors",children:(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-gray-300",children:(0,r.jsx)(d,{})})}),y&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>j(!1)}),(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-gray-900 rounded-lg shadow-lg border border-gray-700/50 py-2 z-50",children:[(0,r.jsx)("div",{className:"px-4 py-3 border-b border-gray-700/50",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-gray-300",children:(0,r.jsx)(d,{})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-200 truncate",children:t.firstName&&t.lastName?"".concat(t.firstName," ").concat(t.lastName).trim():t.firstName||t.lastName||t.email}),(0,r.jsxs)("p",{className:"text-xs text-gray-400 capitalize",children:[t.plan," • ",t.role]})]})]})}),(0,r.jsxs)("div",{className:"py-1",children:[(0,r.jsx)(a,{href:"/".concat(null==R?void 0:R.slug),className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800",onClick:()=>j(!1),children:"Dashboard"}),(0,r.jsx)(a,{href:"/settings",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800",onClick:()=>j(!1),children:"Settings"}),"admin"===t.role&&(0,r.jsx)(a,{href:"/admin",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-gray-800",onClick:()=>j(!1),children:"Admin Dashboard"}),(0,r.jsx)("hr",{className:"my-1 border-gray-700/50"}),(0,r.jsx)("button",{onClick:()=>{j(!1),m()},className:"block w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-red-900/50",children:"Sign Out"})]})]})]})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a,{href:"/login",className:"text-gray-400 hover:text-white transition-colors text-sm font-medium",children:"Log In"}),(0,r.jsx)(a,{href:"/signup",className:"bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-md transition-all text-sm font-semibold border border-gray-600 hover:border-gray-500 shadow-md hover:shadow-lg",children:"Sign Up"})]})})]})})})}},80796:(e,t,s)=>{s.d(t,{V:()=>n,t:()=>o});var r=s(95155),a=s(12115);let l=(0,a.createContext)(null);function n(e){let{children:t}=e,[s,n]=(0,a.useState)(!1);return(0,r.jsx)(l.Provider,{value:{sidebarOpen:s,setSidebarOpen:n},children:t})}function o(){let e=(0,a.useContext)(l);if(null===e)throw Error("useDocsSidebar must be used within a DocsSidebarProvider");return e}}}]);